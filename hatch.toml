[envs.default]
path = ".venv"
dependencies = [
    "pytest<8.0.0,>=7.1.2",
    "pytest-xdist<3.0.0,>=2.5.0",
    "pytest-cov>=3.0.0",
  #"conda-lock[pip_support]>=1.2.1",
  #  "poetry==1.1.*"
]

[envs.default.scripts]
test = "pytest {args}"
cli = "pore-c2 {args}"
cov = ["coverage run --module pytest", "coverage report --show-missing"]
make_test_data = """
        pore-c2 utils create-test-data \
        $WF_POREC_ROOT/test_data \
        --enzyme NlaIII \
        --seed 42122 \
        --num-haplotypes 2  \
        --genome-size 10_000  \
        --cut-rate 0.001 \
        --variant-density 0.05 \
        --num-concatemers 1000  \
        --mean-frags-per-concatemer 10 \
        --p-cis 0.80
"""
lock = [
  "conda-lock -f environment.yml -f conda/dev-environment.yml -p linux-64 --lockfile conda/dev-linux-64.conda-lock.yml",
  "conda-lock render --filename-template 'conda/dev-linux-64.lock' conda/dev-linux-64.conda-lock.yml"
]


[envs.integration]
dependencies = [
    "snakemake>=7.14.0",
    "pytest-workflow>=1.6.0",
]

[envs.integration.scripts]
test = "pytest -c tests/workflow/pytest.ini  tests/workflow/"
create_env = "conda create --name porec2_dev --file conda/dev-linux-64.conda-lock.yml"
update_env = "conda install --name porec2_dev --file conda/dev-linux-64.conda-lock.yml"



[envs.jupyter]
dependencies = [
  "jupyterlab>=3.4.5",
  "jupyterlab-code-formatter>=1.5.3",
  "jupyterlab-lsp>=3.10.1",
  "jupytext>=1.14.1",
  "line-profiler>=3.5.1",
  "memory-profiler>=0.60.0",
  "black>=22.6.0",
  "isort>=5.10.1",
  "ipython",
  "python-lsp-server[all]"
]

[envs.jupyter.scripts]
lab = "jupyter lab"
